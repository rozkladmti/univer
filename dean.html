<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">

    <title>–î–µ–∫–∞–Ω–∞—Ç - –†–æ–∑–∫–ª–∞–¥ –õ–ù–£–í–ú–ë</title>
    
    <script src="https://cdn.jsdelivr.net/npm/xlsx-js-style@1.2.0/dist/xlsx.bundle.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="css/admin-styles.css">
    <style>
        /* –ü—Ä–∏—Ö–æ–≤—É—î–º–æ —Ä–æ–∑–∫–ª–∞–¥ –ø–æ–∫–∏ loader –∞–∫—Ç–∏–≤–Ω–∏–π */
        #schedule-container {
            display: none;
        }
        
        .global-loader.hidden ~ #schedule-container {
            display: grid;
        }
    </style>
</head>
<body>
    <!-- –ì–ª–æ–±–∞–ª—å–Ω–∏–π –ª–æ–∞–¥–µ—Ä –∑ –ø—Ä–æ–≥—Ä–µ—Å-–±–∞—Ä–æ–º —ñ —Å–∫–µ–ª–µ—Ç–æ–Ω–æ–º -->
    <div id="global-loader" class="global-loader hidden">
        <div class="global-loader-header">
            <i class="fa-solid fa-graduation-cap"></i>
            <span>–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ä–æ–∑–∫–ª–∞–¥—É</span>
        </div>
        <div id="global-loader-subtitle" class="global-loader-subtitle">–ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ Google –¢–∞–±–ª–∏—Ü—å‚Ä¶</div>
        <div class="global-loader-bar">
            <div class="global-loader-bar-fill"></div>
        </div>
        <div class="global-loader-skeleton">
            <div class="global-loader-skeleton-day">
                <div class="global-loader-skeleton-day-header"></div>
                <div class="global-loader-skeleton-slot"></div>
                <div class="global-loader-skeleton-slot"></div>
                <div class="global-loader-skeleton-slot"></div>
                <div class="global-loader-skeleton-slot"></div>
            </div>
            <div class="global-loader-skeleton-day">
                <div class="global-loader-skeleton-day-header"></div>
                <div class="global-loader-skeleton-slot"></div>
                <div class="global-loader-skeleton-slot"></div>
                <div class="global-loader-skeleton-slot"></div>
                <div class="global-loader-skeleton-slot"></div>
            </div>
            <div class="global-loader-skeleton-day">
                <div class="global-loader-skeleton-day-header"></div>
                <div class="global-loader-skeleton-slot"></div>
                <div class="global-loader-skeleton-slot"></div>
                <div class="global-loader-skeleton-slot"></div>
                <div class="global-loader-skeleton-slot"></div>
            </div>
            <div class="global-loader-skeleton-day">
                <div class="global-loader-skeleton-day-header"></div>
                <div class="global-loader-skeleton-slot"></div>
                <div class="global-loader-skeleton-slot"></div>
                <div class="global-loader-skeleton-slot"></div>
                <div class="global-loader-skeleton-slot"></div>
            </div>
            <div class="global-loader-skeleton-day">
                <div class="global-loader-skeleton-day-header"></div>
                <div class="global-loader-skeleton-slot"></div>
                <div class="global-loader-skeleton-slot"></div>
                <div class="global-loader-skeleton-slot"></div>
                <div class="global-loader-skeleton-slot"></div>
            </div>
        </div>
    </div>

    <!-- –í–µ—Ä—Ö–Ω—è –ø–∞–Ω–µ–ª—å -->
    <div class="top-bar">
        <!-- –ü–µ—Ä—à–∏–π —Ä—è–¥–æ–∫ -->
        <div class="top-bar-row first">
            <div class="header-left">
                <h2>üéì –î–µ–∫–∞–Ω–∞—Ç - <span id="facultyName">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</span></h2>
                <div class="status-badge st-guest">
                    <i class="fa-solid fa-eye"></i> –¢—ñ–ª—å–∫–∏ –ø–µ—Ä–µ–≥–ª—è–¥
                </div>
                <div id="cloudStatus" class="cloud-status status-saved" title="–°—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó">
                    <i class="fa-solid fa-cloud-check"></i> <span>–ì–æ—Ç–æ–≤–æ</span>
                </div>
            </div>
            
            <div class="week-switcher">
                <button class="week-btn active" id="btn-week-1" onclick="setWeek(1)">–¢–∏–∂–¥–µ–Ω—å I</button>
                <button class="week-btn" id="btn-week-2" onclick="setWeek(2)">–¢–∏–∂–¥–µ–Ω—å II</button>
            </div>
        </div>
        
        <!-- –î—Ä—É–≥–∏–π —Ä—è–¥–æ–∫ -->
        <div class="top-bar-row second">
            <div class="controls-left">
                <select id="departmentSelect" onchange="selectDepartmentFromDropdown()" class="form-input" style="padding: 8px 12px; font-size: 14px; min-width: 200px;">
                    <option value="ALL">üìö –í—Å—ñ –∫–∞—Ñ–µ–¥—Ä–∏</option>
                    <!-- –ó–∞–ø–æ–≤–Ω—é—î—Ç—å—Å—è JS -->
                </select>
            </div>
            <div class="controls-right">
                <button class="btn-sync" id="reloadBtn" onclick="reloadAll()" title="–û–Ω–æ–≤–∏—Ç–∏">
                    <i class="fa-solid fa-rotate"></i> –û–Ω–æ–≤–∏—Ç–∏
                </button>
                <button class="btn-sync btn-export" onclick="exportToExcel()" title="–ï–∫—Å–ø–æ—Ä—Ç –≤ Excel" style="color: #059669; border-color: #a7f3d0; background: #d1fae5;"><i class="fa-solid fa-file-excel"></i></button>
                <button class="btn-sync btn-export" onclick="exportToImage()" title="–ï–∫—Å–ø–æ—Ä—Ç –≤ PNG"><i class="fa-solid fa-camera"></i></button>
                <button class="btn-sync" id="filterBtn" onclick="toggleAdvancedSearch()" title="–ü–æ—à—É–∫ —Ç–∞ —Ñ—ñ–ª—å—Ç—Ä–∏">
                    <i class="fa-solid fa-filter"></i> –§—ñ–ª—å—Ç—Ä–∏
                </button>
                <button class="btn-sync" onclick="openHelp()" title="–î–æ–ø–æ–º–æ–≥–∞">
                    <i class="fa-solid fa-circle-question"></i> –î–æ–ø–æ–º–æ–≥–∞
                </button>
            </div>
        </div>
    </div>

    <!-- –ü–∞–Ω–µ–ª—å –ø–æ—Ç–æ—á–Ω–æ–≥–æ —Ç–∏–∂–Ω—è -->
    <div class="current-week-indicator" id="currentWeekIndicator">
        <i class="fa-solid fa-calendar-week"></i>
        <span id="currentWeekText">–ü–æ—Ç–æ—á–Ω–∏–π —Ç–∏–∂–¥–µ–Ω—å: I</span>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ä–æ–∑–∫–ª–∞–¥—É -->
    <div class="schedule-grid" id="schedule-container">
        <div id="week-watermark">1</div>
        <div class="day-column" id="day-1"><div class="day-header">–ü–æ–Ω–µ–¥—ñ–ª–æ–∫</div></div>
        <div class="day-column" id="day-2"><div class="day-header">–í—ñ–≤—Ç–æ—Ä–æ–∫</div></div>
        <div class="day-column" id="day-3"><div class="day-header">–°–µ—Ä–µ–¥–∞</div></div>
        <div class="day-column" id="day-4"><div class="day-header">–ß–µ—Ç–≤–µ—Ä</div></div>
        <div class="day-column" id="day-5"><div class="day-header">–ü'—è—Ç–Ω–∏—Ü—è</div></div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ: –†–æ–∑—à–∏—Ä–µ–Ω–∏–π –ø–æ—à—É–∫ -->
    <div class="modal-overlay" id="advancedSearchModal">
        <div class="modal-box" style="width: 450px;">
            <div class="modal-header">üîç –†–æ–∑—à–∏—Ä–µ–Ω–∏–π –ø–æ—à—É–∫</div>
            
            <div class="form-group">
                <label class="form-label">–ö–∞—Ñ–µ–¥—Ä–∞</label>
                <select class="form-input" id="advSearchDepartment">
                    <option value="">–í—Å—ñ –∫–∞—Ñ–µ–¥—Ä–∏</option>
                    <!-- –ó–∞–ø–æ–≤–Ω—é—î—Ç—å—Å—è JS -->
                </select>
            </div>
            
            <div class="form-group">
                <label class="form-label">–í–∏–∫–ª–∞–¥–∞—á</label>
                <input class="form-input" type="text" id="advSearchTeacher" list="teachersList" placeholder="–í—Å—ñ –≤–∏–∫–ª–∞–¥–∞—á—ñ">
            </div>
            
            <div class="form-group">
                <label class="form-label">–ì—Ä—É–ø–∞</label>
                <input class="form-input" type="text" id="advSearchGroup" list="groupsList" placeholder="–í—Å—ñ –≥—Ä—É–ø–∏">
            </div>
            
            <div class="form-group">
                <label class="form-label">–ü—Ä–µ–¥–º–µ—Ç</label>
                <input class="form-input" type="text" id="advSearchSubject" list="subjectsList" placeholder="–í—Å—ñ –ø—Ä–µ–¥–º–µ—Ç–∏">
            </div>
            
            <div class="form-group">
                <label class="form-label">–¢–∏–ø –∑–∞–Ω—è—Ç—Ç—è</label>
                <select class="form-input" id="advSearchType">
                    <option value="">–í—Å—ñ —Ç–∏–ø–∏</option>
                    <option value="–õ–µ–∫—Ü—ñ—è">–õ–µ–∫—Ü—ñ—è</option>
                    <option value="–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞">–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞</option>
                    <option value="–ü—Ä–∞–∫—Ç–∏—á–Ω–∞">–ü—Ä–∞–∫—Ç–∏—á–Ω–∞</option>
                    <option value="–°–µ–º—ñ–Ω–∞—Ä">–°–µ–º—ñ–Ω–∞—Ä</option>
                </select>
            </div>

            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeAdvancedSearch()">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
                <button class="btn btn-primary" onclick="applyAdvancedSearch()">–ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏</button>
            </div>
        </div>
    </div>

    <!-- Datalists -->
    <datalist id="teachersList"></datalist>
    <datalist id="groupsList"></datalist>
    <datalist id="subjectsList"></datalist>
    <datalist id="roomsList"></datalist>

    <!-- –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ: –î–æ–ø–æ–º–æ–≥–∞ -->
    <div class="modal-overlay" id="helpModal">
        <div class="modal-box" style="width: 600px; max-height: 80vh; overflow-y: auto;">
            <div class="modal-header">üí° –î–æ–≤—ñ–¥–∫–∞</div>
            <div style="padding: 20px; line-height: 1.6;">
                <h3 style="margin-top: 0;">–ü–∞–Ω–µ–ª—å –¥–µ–∫–∞–Ω–∞ —Ñ–∞–∫—É–ª—å—Ç–µ—Ç—É</h3>
                <p>–¶–µ–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–æ–∑–≤–æ–ª—è—î –ø–µ—Ä–µ–≥–ª—è–¥–∞—Ç–∏ —Ä–æ–∑–∫–ª–∞–¥ –∑–∞–Ω—è—Ç—å –≤—Å—ñ—Ö –∫–∞—Ñ–µ–¥—Ä –≤–∞—à–æ–≥–æ —Ñ–∞–∫—É–ª—å—Ç–µ—Ç—É.</p>

                <h4 style="margin-top: 1.5rem;">üîç –ú–æ–∂–ª–∏–≤–æ—Å—Ç—ñ:</h4>
                <ul>
                    <li><strong>–ü–µ—Ä–µ–≥–ª—è–¥ —Ä–æ–∑–∫–ª–∞–¥—É</strong> –≤—Å—ñ—Ö –∫–∞—Ñ–µ–¥—Ä –∞–±–æ –æ–∫—Ä–µ–º–æ—ó –∫–∞—Ñ–µ–¥—Ä–∏</li>
                    <li><strong>–§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è</strong> –ø–æ –≤–∏–∫–ª–∞–¥–∞—á–∞—Ö, –≥—Ä—É–ø–∞—Ö, –ø—Ä–µ–¥–º–µ—Ç–∞—Ö, –¥–Ω—è—Ö</li>
                    <li><strong>–ï–∫—Å–ø–æ—Ä—Ç –≤ Excel</strong> –¥–ª—è –¥—Ä—É–∫—É —Ç–∞ –∞–Ω–∞–ª—ñ–∑—É</li>
                    <li><strong>–ï–∫—Å–ø–æ—Ä—Ç –≤ PNG</strong> –¥–ª—è —à–≤–∏–¥–∫–æ–≥–æ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è</li>
                    <li><strong>–ü–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è —Ç–∏–∂–Ω—ñ–≤</strong> (I/II) –¥–ª—è –ø–ª–∞–Ω—É–≤–∞–Ω–Ω—è</li>
                </ul>

                <h4 style="margin-top: 1.5rem;">üìå –ü—ñ–¥–∫–∞–∑–∫–∏:</h4>
                <ul>
                    <li>–û–±–µ—Ä—ñ—Ç—å –∫–∞—Ñ–µ–¥—Ä—É –∑—ñ —Å–ø–∏—Å–∫—É –¥–ª—è —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó —Ä–æ–∑–∫–ª–∞–¥—É</li>
                    <li>"–í—Å—ñ –∫–∞—Ñ–µ–¥—Ä–∏" –ø–æ–∫–∞–∑—É—î –∑–≤–µ–¥–µ–Ω–∏–π —Ä–æ–∑–∫–ª–∞–¥ —Ñ–∞–∫—É–ª—å—Ç–µ—Ç—É</li>
                    <li>–ö–Ω–æ–ø–∫–∞ <span style="color: #3b82f6;"><i class="fa-solid fa-filter"></i> –§—ñ–ª—å—Ç—Ä–∏</span> - —Ä–æ–∑—à–∏—Ä–µ–Ω–∏–π –ø–æ—à—É–∫ –ø–∞—Ä</li>
                    <li>–ö–Ω–æ–ø–∫–∞ <span style="color: #059669;"><i class="fa-solid fa-file-excel"></i></span> - –µ–∫—Å–ø–æ—Ä—Ç –æ–±–æ—Ö —Ç–∏–∂–Ω—ñ–≤ –≤ Excel</li>
                    <li>–ö–Ω–æ–ø–∫–∞ <i class="fa-solid fa-camera"></i> - —Å–∫—Ä—ñ–Ω—à–æ—Ç –ø–æ—Ç–æ—á–Ω–æ–≥–æ —Ç–∏–∂–Ω—è</li>
                    <li>–ù–∞—Ç–∏—Å–Ω—É–≤—à–∏ <span style="color: #f59e0b;"><i class="fa-solid fa-filter"></i> –°–∫–∏–Ω—É—Ç–∏</span> –º–æ–∂–Ω–∞ –æ—á–∏—Å—Ç–∏—Ç–∏ –≤—Å—ñ —Ñ—ñ–ª—å—Ç—Ä–∏</li>
                </ul>

                <h4 style="margin-top: 1.5rem;">‚ö†Ô∏è –ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É:</h4>
                <p style="background: #fef3c7; padding: 12px; border-radius: 6px; border-left: 4px solid #f59e0b;">
                    <i class="fa-solid fa-eye"></i> <strong>–†–µ–∂–∏–º "–¢—ñ–ª—å–∫–∏ –ø–µ—Ä–µ–≥–ª—è–¥"</strong><br>
                    –í–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≥–ª—è–¥–∞—Ç–∏ —Ç–∞ –µ–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ —Ä–æ–∑–∫–ª–∞–¥, –∞–ª–µ –Ω–µ –º–æ–∂–µ—Ç–µ –π–æ–≥–æ —Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏. –î–ª—è –≤–Ω–µ—Å–µ–Ω–Ω—è –∑–º—ñ–Ω –∑–≤–µ—Ä–Ω—ñ—Ç—å—Å—è –¥–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ —Å–∏—Å—Ç–µ–º–∏.
                </p>

                <div style="margin-top: 1.5rem; padding-top: 1rem; border-top: 1px solid #e2e8f0;">
                    <p style="font-size: 0.85rem; color: #64748b;">
                        <strong>–í–µ—Ä—Å—ñ—è:</strong> 2.0 | <strong>–û–Ω–æ–≤–ª–µ–Ω–æ:</strong> –õ—é—Ç–∏–π 2026
                    </p>
                    <p style="margin: 0.8rem 0 0 0; font-size: 0.8rem; color: #64748b;">
                        ¬© 2026 –ö–∞—Ñ–µ–¥—Ä–∞ –ú–µ–Ω–µ–¥–∂–º–µ–Ω—Ç—É –Ü–¢-—Å—Ñ–µ—Ä–∏ –õ–ù–£–í–ú–ë —ñ–º–µ–Ω—ñ –°.–ó. –ì–∂–∏—Ü—å–∫–æ–≥–æ
                    </p>
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn btn-primary" onclick="closeHelp()">–ó—Ä–æ–∑—É–º—ñ–ª–æ!</button>
            </div>
        </div>
    </div>

    <!-- –ö–∞—Å—Ç–æ–º–Ω–∏–π Alert -->
    <div class="modal-overlay" id="customAlertModal">
        <div class="modal-box" style="max-width: 450px; animation: modalBounce 0.3s ease;">
            <div id="customAlertIcon" style="text-align: center; font-size: 48px; margin: 20px 0 10px 0;">
                <i class="fa-solid fa-circle-info" style="color: #3b82f6;"></i>
            </div>
            <div class="modal-header" id="customAlertTitle" style="text-align: center; font-size: 20px; padding: 10px 20px;">–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è</div>
            <div style="padding: 10px 30px 30px 30px; text-align: center; font-size: 15px; line-height: 1.6; color: #475569;" id="customAlertMessage"></div>
            <div class="modal-actions" id="customAlertActions" style="gap: 10px; padding: 0 20px 20px 20px;">
                <button class="btn btn-primary" onclick="closeCustomAlert(true)" style="min-width: 100px;">OK</button>
            </div>
        </div>
    </div>

    <script src="js/shared-config.js"></script>
    <script src="js/config-dean.js"></script>
    <script src="js/dean-script.js"></script>
</body>
</html>
